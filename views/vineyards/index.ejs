<% layout('layouts/boilerplate')%>

<div id="map" style="width: 100%; height:45vh; margin-top:0;"></div>

    <h3 class="mt-4" style="color: #198754;">All Vineyards & Wineries</h3>
    
        
    
    <div class="mb-3" style="height:60vh; overflow: hidden; overflow-y:scroll;">
        <% for (let vineyard of vineyards) {%>
            <div class="card mb-3">
                <div class="row">
                    <div class="col-md-4">
            
                        <img class="img-fluid mx-auto" 
                            style="height: 40vh; width: 100%; object-position: center; overflow:none;" 
                            src="<%=vineyard.images[0].url%>">
            
                    </div>
                    <div class="col-md-8">
                        <div class="card-body">
                            <h5 class="card-title" style="color: #198754;"><%= vineyard.title %></h5>
                            <p class="card-text"><%= vineyard.description %></p>
                            <p class="card-text"><%= vineyard.category %> | <%= vineyard.style %> | <%= vineyard.price %></p>
                            <p class="card-text" ><small><%= vineyard.location %></small></p>
                            <a class="btn btn-success" href="/vineyards/<%= vineyard._id%>">View <%= vineyard.title %></a>
                        </div>
                    </div>
                </div>

            </div>
            <% } %>
        </div>

<script>
const mapToken = '<%-process.env.MAPBOX_TOKEN%>';
const vineyards = {features: <%-JSON.stringify(vineyards)%>}
</script>    
<script src="/javascripts/clusterMap.js"></script>